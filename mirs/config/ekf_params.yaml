ekf_filter_node:
  ros__parameters:
    frequency: 30.0
    two_d_mode: true
    publish_tf: true

    # ランドマーク（地図）を使うので、map座標系を有効
    map_frame: map
    odom_frame: odom
    base_link_frame: base_link
    world_frame: odom      # 最終的な出力座標系を map に固定

    # --- 入力1: エンコーダー (足回り) ---
    # 役割: 短い時間の滑らかな移動を担当
    odom0: /odom
    odom0_config: [false, false, false,
                   false, false, false,
                   true,  true,  false,   # vx, vy (移動速度)
                   false, false, true,    # vyaw (旋回速度)
                   false, false, false]
    odom0_differential: false
    odom0_relative: false

    # --- 入力2: 自作ノードからのランドマーク位置推定 ---
    # 役割: 位置ズレと累積誤差の補正 (IMUの代わりにもなる)
    pose0: /landmark_pose   # 自作ノードがPublishするトピック名
    
    # 絶対位置 (X, Y) と 方位 (Yaw) を修正します
    pose0_config: [true,  true,  false,   # X, Y (地図上の位置)
                   false, false, true,    # Yaw (地図上の向き)
                   false, false, false,
                   false, false, false,
                   false, false, false]
    
    # ランドマークは絶対座標なので differential は false
    pose0_differential: false
    pose0_relative: false
